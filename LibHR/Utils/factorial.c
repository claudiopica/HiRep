/***************************************************************************
 * Copyright (c) 2023, Sofie Martins                                        *
 * All rights reserved.                                                     *
 ***************************************************************************/

#include "libhr_core.h"
#include "utils.h"

#ifdef __cplusplus
extern "C" {
#endif

#if MAX_FACTORIAL > 100
#error "MAX_FACTORIAL cannot be larger than 100. There is probably no reason, to calculate inverse factorials this high."
#endif

visible double inverse_fact(int i) {
    static const double inv_fact[] = { 1.0,
                                       1.0,
                                       0.5,
                                       0.16666666666666666,
                                       0.041666666666666664,
                                       0.008333333333333333,
                                       0.001388888888888889,
                                       0.0001984126984126984,
                                       2.48015873015873e-05,
                                       2.7557319223985893e-06,
                                       2.755731922398589e-07,
                                       2.505210838544172e-08,
                                       2.08767569878681e-09,
                                       1.6059043836821613e-10,
                                       1.1470745597729725e-11,
                                       7.647163731819816e-13,
                                       4.779477332387385e-14,
                                       2.8114572543455206e-15,
                                       1.5619206968586225e-16,
                                       8.22063524662433e-18,
                                       4.110317623312165e-19,
                                       1.9572941063391263e-20,
                                       8.896791392450574e-22,
                                       3.8681701706306835e-23,
                                       1.6117375710961184e-24,
                                       6.446950284384474e-26,
                                       2.4795962632247972e-27,
                                       9.183689863795546e-29,
                                       3.279889237069838e-30,
                                       1.1309962886447718e-31,
                                       3.7699876288159054e-33,
                                       1.2161250415535181e-34,
                                       3.800390754854744e-36,
                                       1.151633562077195e-37,
                                       3.387157535521162e-39,
                                       9.67759295863189e-41,
                                       2.688220266286636e-42,
                                       7.265460179153071e-44,
                                       1.911963205040282e-45,
                                       4.902469756513544e-47,
                                       1.225617439128386e-48,
                                       2.9893108271424046e-50,
                                       7.117406731291439e-52,
                                       1.6552108677421951e-53,
                                       3.7618428812322616e-55,
                                       8.359650847182804e-57,
                                       1.817315401561479e-58,
                                       3.866628513960594e-60,
                                       8.055476070751238e-62,
                                       1.643974708316579e-63,
                                       3.2879494166331584e-65,
                                       6.446959640457174e-67,
                                       1.2397999308571486e-68,
                                       2.3392451525606576e-70,
                                       4.331935467704922e-72,
                                       7.876246304918039e-74,
                                       1.4064725544496498e-75,
                                       2.4674957095607893e-77,
                                       4.254302947518602e-79,
                                       7.210682961895936e-81,
                                       1.2017804936493227e-82,
                                       1.9701319568021682e-84,
                                       3.177632188390594e-86,
                                       5.043860616493007e-88,
                                       7.881032213270323e-90,
                                       1.2124664943492803e-91,
                                       1.8370704459837581e-93,
                                       2.74189618803546e-95,
                                       4.0322002765227353e-97,
                                       5.843768516699617e-99,
                                       8.348240738142308e-101,
                                       1.1758085546679308e-102,
                                       1.633067437038793e-104,
                                       2.2370786808750587e-106,
                                       3.023079298479809e-108,
                                       4.030772397973078e-110,
                                       5.30364789206984e-112,
                                       6.887854405285506e-114,
                                       8.830582570878855e-116,
                                       1.117795262136564e-117,
                                       1.397244077670705e-119,
                                       1.724992688482352e-121,
                                       2.103649620100429e-123,
                                       2.53451761457883e-125,
                                       3.0172828744986073e-127,
                                       3.549744558233656e-129,
                                       4.127609951434483e-131,
                                       4.7443792545223946e-133,
                                       5.3913400619572666e-135,
                                       6.057685462873333e-137,
                                       6.730761625414815e-139,
                                       7.396441346609687e-141,
                                       8.039610159358354e-143,
                                       8.64474210683694e-145,
                                       9.196534156209511e-147,
                                       9.680562269694223e-149,
                                       1.0083919030931482e-150,
                                       1.039579281539328e-152,
                                       1.0607951852442122e-154,
                                       1.0715102881254669e-156,
                                       1.071510288125467e-158 };
    return inv_fact[i];
}

#ifdef __cplusplus
}
#endif
