/***************************************************************************\
* Copyright (c) 2008, Claudio Pica and Agostino Patella                     *
* All rights reserved.                                                      *
\***************************************************************************/

#include <string.h>

// Error checking
#if !defined(_FIELD_TYPE)
#error Missing _FIELD_TYPE in linear_algebra.c
#endif
#if !defined(_FIELD_DIM)
#error Missing _FIELD_DIM in linear_algebra.c
#endif
#if !defined(_SITE_TYPE)
#error Missing _SITE_TYPE in linear_algebra.c
#endif
#if !defined(_REAL)
#error Missing _REAL in linear_algebra.c
#endif
#if !defined(_COMPLEX)
#error Missing _COMPLEX in linear_algebra.c
#endif

/* s1=s2 */
_DECLARE_LINEAR_ALGEBRA(void, copy, (_FIELD_TYPE * s1, _FIELD_TYPE *s2)) {
    _TWO_SPINORS_MATCHING(s1, s2);
    _TWO_SITE_FOR(s1, s2) {
        for (int mu = 0; mu < _FIELD_DIM; ++mu) {
            memcpy(_SITE_PTR(s1, mu, _FIELD_DIM), _SITE_PTR(s2, mu, _FIELD_DIM), sizeof(_SITE_TYPE));
        }
    }
}

/* s1=0 */
_DECLARE_LINEAR_ALGEBRA(void, zero, (_FIELD_TYPE * s1)) {
    _ONE_SITE_FOR(s1) {
        for (int mu = 0; mu < _FIELD_DIM; ++mu) {
            memset(_SITE_PTR(s1, mu, _FIELD_DIM), 0, sizeof(_SITE_TYPE));
        }
    }
}

//user interface macros
#undef _FIELD_TYPE
#undef _SITE_TYPE
#undef _FIELD_DIM
#undef _REAL
#undef _COMPLEX
#undef _ISREAL
