<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HiRep: Analysis</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init();
    DoxygenAwesomeInteractiveToc.init();
</script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<!-- <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/SVG"],
});
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "all" } },
  "HTML-CSS": { linebreaks: { automatic: true } },
  SVG: { linebreaks: { automatic: true } }
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
 -->
<script>
  window.MathJax = {
    tex: {
      tags: "all",
      packages: ['base', 'ams']
    },
    options: {
      ignoreHtmlClass: 'tex2jax_ignore',
      processHtmlClass: 'tex2jax_process',
      lazyMargin: '1200px',
    },
    loader: {load: ['ui/lazy']}
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
<!-- $darkmode -->
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
  <!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/claudiopica/HiRep" class="github-corner" title="View project on GitHub" target="_blank">
  <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
  <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HiRep<span id="projectnumber">&#160;0.1</span>
   </div>
   <!-- BEGIN PROJECT_BRIEF<div id="projectbrief">HiRep</div>END PROJECT_BRIEF -->
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('db/dc7/md_user_guide_analysis.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Analysis </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1">Contractions</a><ul><li class="level2"><a href="#autotoc_md2">Connected Two-Point Correlation Functions</a></li>
<li class="level2"><a href="#autotoc_md3">Point Sources</a></li>
<li class="level2"><a href="#autotoc_md4">One-end Trick</a></li>
<li class="level2"><a href="#autotoc_md5">Disconnected</a></li>
<li class="level2"><a href="#autotoc_md6">Cancelling Backwards Propagation</a></li>
<li class="level2"><a href="#autotoc_md7">Form Factors and Sequential Sources</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md8">Estimation of Disconnected Contributions</a><ul><li class="level2"><a href="#autotoc_md9">Conventions</a></li>
<li class="level2"><a href="#autotoc_md10">Singlet Two-Point Functions</a></li>
<li class="level2"><a href="#autotoc_md11">Stochastic Evaluation of Disconnected Loops</a></li>
<li class="level2"><a href="#autotoc_md12">Output</a></li>
<li class="level2"><a href="#autotoc_md13">Debugging Options</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md14">Mesonic Correlators of the Isotriplet</a><ul><li class="level2"><a href="#autotoc_md15">Implementation of the Point-To-All Propagator</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md16">Mesonic Correlators of the Isosinglet</a><ul><li class="level2"><a href="#autotoc_md17">All-to-all Propagator</a></li>
<li class="level2"><a href="#autotoc_md18">Variance reduction</a></li>
<li class="level2"><a href="#autotoc_md19">Time dilution</a></li>
<li class="level2"><a href="#autotoc_md20">Implementation Scheme</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p ><a class="anchor" id="analysis"></a> </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Contractions</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Connected Two-Point Correlation Functions</h2>
<p >First we choose interpolating operators with the quantum numbers of the meson we would like to study:</p>
<p class="formulaDsp">
\begin{equation}O_M = \bar{\psi}^{(1)}(x) \Gamma \psi^{(2)}(x)\end{equation}
</p>
<p class="formulaDsp">
\begin{equation}\bar{O}_M = \bar{\psi}^{(2)}(x) \bar{ \Gamma } \psi^{(1)}(x)\end{equation}
</p>
<p >where \( \bar{ \Gamma } = \gamma_0 \Gamma^\dagger \gamma_0 \). The gamma matrix is chosen to have the same \( J^{PC} \) quantum numbers as the meson we want to create. We then calculate the expectation value to create a meson at \( y \) and destroy it again at \( x \) :</p>
<p class="formulaDsp">
\begin{equation}
    \begin{aligned}
\langle O_M(x) \bar{O}_M&#39;(y) \rangle =&amp; \langle \bar{\psi}^{(1)}(x) \Gamma \psi^{(2)}(x) \bar{\psi}^{(2)}(y) \bar{ \Gamma }&#39; \psi^{(1)}(y) \rangle 
\\
=&amp; \Gamma_{\alpha \beta} \bar{ \Gamma }&#39;_{\gamma \delta} \langle \bar{\psi}^{(1)}_\alpha(x)  \psi^{(2)}_\beta(y) \bar{\psi}^{(2)}_\gamma(y)  \psi^{(1)}_\delta(x) \rangle \\
=&amp; -\Gamma_{\alpha \beta} \bar{ \Gamma }&#39;_{\gamma \delta} \langle \psi^{(2)}_\beta(x) \bar{\psi}^{(2)}_\gamma(y)  \psi^{(1)}_\delta(y) 
\bar{\psi}^{(1)}_\alpha (x) \rangle
\end{aligned}
\label{eq:2ptcorr}
\end{equation}
</p>
<p >where the sign in the last line comes from exchanging the anticommuting \( \bar{\psi}_\alpha \) three times. Wick contracting where \( \langle \psi_\alpha(x) \bar{\psi}_\beta(y) \rangle = S_{\alpha \beta}(x,y) \) gives</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
\langle O_M(x) \bar{O}_M&#39;(y) \rangle =&amp; -\Gamma_{\alpha \beta} S^{(2)}_{\beta \gamma} (x,y) \bar{ \Gamma }&#39;_{\gamma \delta} S^{(1)}_{\delta \alpha} (y,x) \\
=&amp; -\text{Tr}\left[ \Gamma S^{(2)} (x,y) \bar{ \Gamma }&#39; S^{(1)} (y,x) \right]\end{aligned}
\end{equation}
</p>
<p >To get correlation functions we Fourier transform, ie. sum over all source and sink seperations while projecting onto the momentum we want to give to the particle:</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C(t - \tau, \vec{p}) =&amp; \sum_{\vec{x} \vec{y}} e^{-i \vec{p}(\vec{x} - \vec{y}) } \langle O_M(\vec{x}, t) O_M&#39;(\vec{y}, \tau)\rangle \\
=&amp; -\sum_{\vec{x} \vec{y}} e^{-i \vec{p}(\vec{x} - \vec{y}) } \text{Tr}\left[ \Gamma S^{(2)} (x,y) \bar{ \Gamma }&#39; S^{(1)} (y,x) \right]\end{aligned}\end{equation}
</p>
<p >here \( x = (\vec{x}, t) \) and \( y = (\vec{y}, \tau) \) and the zero momentum correlator is:</p>
<p class="formulaDsp">
\begin{equation}C(t - \tau, 0) = -\sum_{\vec{x} \vec{y}} \text{Tr}\left[ \Gamma S^{(2)} (x,y) \bar{ \Gamma }&#39; S^{(1)} (y,x) \right]\end{equation}
</p>
<p >We now use \( \gamma_5 \) Hermiticity: \( \gamma_5 S^\dagger(x,y) \gamma_5 = S(y,x) \),</p>
<p class="formulaDsp">
\begin{equation}C(t - \tau, 0) = -\sum_{\vec{x} \vec{y}} \text{Tr}\left[ \gamma_5 \Gamma S^{(2)} (x,y) \bar{ \Gamma }&#39; \gamma_5 S^{\dagger (1)} (x,y) \right]\label{eqn:corr}\end{equation}
</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Point Sources</h2>
<p >Using a delta function source and solving the Dirac equation gives a point propagator,</p>
<p class="formulaDsp">
\begin{equation}D_{\alpha a, \beta b} (x,y) S_{\beta b, \gamma c} (y, z) = \delta(x,z) \delta_{ac} \delta_{\alpha \gamma}\end{equation}
</p>
<p >usually \( z = (\vec{0}, 0) \) so we get \( S(y,0) = \gamma_5 S^{\dagger} (0,y) \gamma_5 \). Then we use these to calculate correlation functions,</p>
<p class="formulaDsp">
\begin{equation}C(t, 0) = -\sum_{\vec{x}} \text{Tr} e^{-i \vec{p} \vec{x}} \left[ \gamma_5 \Gamma S (x,0) \bar{ \Gamma }&#39; \gamma_5 S (x,0) \right]\label{eqn:pointcorr}\end{equation}
</p>
<p >Translational invariance in the limit of infinitely many gauge configurations implies \( S(x,y) = S(|x - y|) \), so the sum over \( \vec{y} \) in equation eq. \((\ref{eqn:corr})\) just gives \( V \) times equation eq. \((\ref{eqn:pointcorr})\). We place the source at the time origin so \( \tau = 0 \).</p>
<h2><a class="anchor" id="autotoc_md4"></a>
One-end Trick</h2>
<p >For this method it helps to write all the indices out,</p>
<p class="formulaDsp">
\begin{equation}C(t - \tau, 0) = -\sum_{\vec{x} \vec{y}} (\gamma_5 \Gamma)_{\alpha \beta} S^{(2)}_{\beta\gamma,bc} (x,y) (\bar{ \Gamma }&#39; \gamma_5)_{\gamma \delta} S^{\dagger (1)}_{\delta \alpha, cb} (x,y)\end{equation}
</p>
<p >Greek indices \( \alpha, \beta, \gamma, \delta, ... \) are spinor indices and Latin indices \( a, b, c, d... \) are colour indices. The one-end trick involves inserting a delta function in colour, spin and space.</p>
<p class="formulaDsp">
\begin{equation}C(t - \tau, 0) = -\sum_{\vec{x} \vec{y} \vec{z}} (\gamma_5 \Gamma)_{\alpha \beta} S^{(2)}_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) \delta_{\gamma \lambda} \delta_{cd} \delta(\vec{y}, \vec{z}) (\bar{ \Gamma }&#39; \gamma_5)_{\lambda \delta} S^{\dagger (1)}_{\delta \alpha, d b} (\vec{x}, t;\vec{z}, \tau)\end{equation}
</p>
<p >The delta function is aproximated with a \( Z(2) \times Z(2) \) noise source on timeslice \( \tau \)</p>
<p class="formulaDsp">
\begin{equation}\delta_{\gamma \lambda} \delta_{cd} \delta(\vec{y}, \vec{z}) \approx \frac{1}{K} \sum_{k = 0}^{K} | \eta^{(k)}_{\gamma c }(\vec{y})\rangle \langle \eta^{(k)}_{\lambda d }(\vec{z}) |\end{equation}
</p>
<p >which is exact in the limit \( K \rightarrow \infty \).</p>
<p class="formulaDsp">
\begin{equation}
C(t - \tau, 0) = -\frac{1}{K} \sum_{k = 0}^{K} \sum_{\vec{x} \vec{y} \vec{z}} (\gamma_5 \Gamma)_{\alpha \beta} S^{(2)}_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) | \eta^{(k)}_{\gamma c }(\vec{y})\rangle \langle \eta^{(k)}_{\lambda d }(\vec{z}) | (\bar{ \Gamma }&#39; \gamma_5)_{\lambda \delta} S^{\dagger (1)}_{\delta \alpha, d b} (\vec{x}, t;\vec{z}, \tau)\label{eq:oet}\end{equation}
</p>
<p >Defining</p>
<p class="formulaDsp">
\begin{equation}\phi^{(k)}_{\beta, b}(\vec{x}, t; \tau) = \sum_{\vec{y}} S^{(2)}_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) | \eta^{(k)}_{\gamma c }(\vec{y})\rangle\end{equation}
</p>
<p >and</p>
<p class="formulaDsp">
\begin{equation}\phi^{\Gamma (k)}_{\alpha, b}(\vec{x}, t; \tau) = \sum_{\vec{z}} S^{(1)}_{\alpha \delta , b d} (\vec{x}, t;\vec{z}, \tau) (\bar{ \Gamma }&#39; \gamma_5)^{\dagger}_{\delta \lambda} | \eta^{(k)}_{\lambda d }(\vec{z}) \rangle\end{equation}
</p>
<p >the correlator can be evaluated as,</p>
<p class="formulaDsp">
\begin{equation}C(t - \tau, 0) = -\frac{1}{K} \sum_{k = 0}^{K} \sum_{\vec{x} } (\gamma_5 \Gamma)_{\alpha \beta} \phi^{(k)}_{\beta, b}(\vec{x}, t; \tau) \phi^{\Gamma \dagger (k)}_{\alpha, b}(\vec{x}, t; \tau)\end{equation}
</p>
<h3>Implementation in HiRep</h3>
<p >In HiRep the code <code>Spectrum/mk_mesons_with_z2semwall.c</code> does two solves to calculate \( S^{(1)} | \eta \rangle \) and \( S^{(2)} (\bar{ \Gamma }&#39; \gamma_5)^{\dagger} | \eta \rangle \). HiRep has</p>
<p class="formulaDsp">
\begin{equation}\rho = \rho_{ c }(\vec{y})\end{equation}
</p>
<p >a \( Z(2) \times Z(2) \) colour vector at all (even) spatial sites \( \vec{y} \) and non-zero only on timeslice \( \tau \).</p>
<p class="formulaDsp">
\begin{equation}\rho^{\alpha}_\beta = \delta_{\alpha \beta} \rho^\alpha\end{equation}
</p>
<p >eg.</p>
<p class="formulaDsp">
\begin{equation}\rho^1_\beta = \left( \begin{matrix}
  0 \\
  \rho^1 \\
  0 \\
  0
 \end{matrix} \right)\end{equation}
</p>
<p >It then solves for the four objects</p>
<p class="formulaDsp">
\begin{equation}\chi^\alpha_\beta = S_{\beta \gamma} \rho^{\alpha}_\gamma\end{equation}
</p>
<p >eg.</p>
<p class="formulaDsp">
\begin{equation}\chi^0_\beta = \left( \begin{matrix}
  S_{00} \rho^0 \\
  S_{10} \rho^0 \\
  S_{20} \rho^0 \\
  S_{30} \rho^0
 \end{matrix} \right)\end{equation}
</p>
<p >For every different \( \Gamma \) that is required it does four more inversions,</p>
<p class="formulaDsp">
\begin{equation}\chi^{\Gamma \alpha}_\beta = S_{\beta \gamma} (\Gamma \gamma_5)^\dagger_{\gamma \delta} \rho^{\alpha}_\delta\end{equation}
</p>
<p >before calculating the correlator as,</p>
<p class="formulaDsp">
\begin{equation}C(t - \tau, 0) = -\frac{1}{K} \sum_{k = 0}^{K} \sum_{\lambda = 0}^{3}\sum_{\vec{x} } (\gamma_5 \Gamma)_{\alpha \beta} \chi^{\lambda}_{\beta, b}(\vec{x}, t; \tau) \chi^{\Gamma \lambda \dagger}_{\alpha, b}(\vec{x}, t; \tau)\end{equation}
</p>
<p >where the \( \lambda \) sum is over the \( 4 \) spinor components.</p>
<p >We should be able to improve the signal and reduce the number of inversions with two modifications. First, instead of having a different noise vector for every spin component we reuse the same noise, i.e.</p>
<p class="formulaDsp">
\begin{equation}\rho^{\alpha}_\beta = \delta_{\alpha \beta} \rho\end{equation}
</p>
<p >for fixed \( \rho \). Using less noise seems to be generally preferred.</p>
<p >Secondly there is no need to invert for every different \( \Gamma \). Let,</p>
<p class="formulaDsp">
\begin{equation}\chi^{\Gamma \alpha}_\beta = (\Gamma \gamma_5)^\dagger_{\gamma \alpha} \chi^{\gamma}_\beta\end{equation}
</p>
<p >This is true because,</p>
<p class="formulaDsp">
\begin{equation}(\Gamma \gamma_5)^\dagger_{\gamma \alpha} \chi^{\gamma}_\beta = (\Gamma \gamma_5)^\dagger_{\gamma \alpha}
S_{\beta \delta} \rho^{\gamma}_\delta = (\Gamma \gamma_5)^\dagger_{\gamma \alpha}
S_{\beta \delta} \delta_{\gamma \delta} \rho = (\Gamma \gamma_5)^\dagger_{\gamma \alpha}
S_{\beta \gamma} \rho = S_{\beta \gamma} (\Gamma \gamma_5)^\dagger_{\gamma \alpha} \rho\end{equation}
</p>
<p >then the correlation function is</p>
<p class="formulaDsp">
\begin{equation}C(t - \tau, 0) = -\frac{1}{K} \sum_{k = 0}^{K} \sum_{\lambda = 0}^{3}\sum_{\vec{x} } (\gamma_5 \Gamma)_{\alpha \beta} \chi^{\lambda}_{\beta, b}(\vec{x}, t; \tau) \chi^{\Gamma \lambda \dagger}_{\alpha, b}(\vec{x}, t; \tau)\end{equation}
</p>
<p >as before. By using the spin_matrix object in HiRep to construct the objects \( \chi^{\lambda}_{\beta, b} \) the correlators can be calculated with only \( 4 N_F \) inversions.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Disconnected</h2>
<p >The disconnected contributions occur when we have fermion species of the same type in the hadron interpolator \( O_M \) :</p>
<p class="formulaDsp">
\begin{equation}O_M(x) = \bar{ \psi } (x) \Gamma \psi(x)\end{equation}
</p>
<p >The same manipulations that lead to equation eq. \((\ref{eq:2ptcorr})\) give,</p>
<p class="formulaDsp">
\begin{equation}\langle O_M(x) \bar{O}_M&#39;(y) \rangle = \langle \bar{\psi}(x) \Gamma \psi(x) \bar{\psi}(y) \bar{ \Gamma }&#39; \psi(y) \rangle = \Gamma_{\alpha \beta} \bar{ \Gamma }&#39;_{\gamma \delta} \langle \bar{\psi}_\alpha(x)  \psi_\beta(y) \bar{\psi}_\gamma(y)  \psi_\delta(x) \rangle\end{equation}
</p>
<p >There are two allowed Wick contractions,</p>
<p class="formulaDsp">
\begin{equation}\langle O_M(x) \bar{O}_M&#39;(y) \rangle = -\text{Tr}\left[ \Gamma S (x,y) \bar{ \Gamma }&#39; S (y,x) \right] + \text{Tr}\left[ \Gamma S (x,x) \right] \text{Tr} \left[ \bar{ \Gamma }&#39; S (y,y) \right]\end{equation}
</p>
<p >the connected and disconnected contributions. Fourier transforming the first term gives us the same result as before. For the disconnected part,</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
D(t - \tau, \vec{p}) = \sum_{\vec{x} \vec{y}} e^{-i \vec{p} (\vec{x} - \vec{y} )} \text{Tr}\left[ \Gamma S (x,x) \right] \text{Tr} \left[ \bar{ \Gamma }&#39; S (y,y) \right]\end{aligned}\end{equation}
</p>
<p >again \( x = (\vec{x}, t) \) and \( y = (\vec{y}, \tau) \), the zero-momentum correlator is</p>
<p class="formulaDsp">
\begin{equation}D(t - \tau, 0) = \sum_{\vec{x} \vec{y}} \text{Tr}\left[ \Gamma S (x,x) \right] \text{Tr} \left[ \bar{ \Gamma }&#39; S (y,y) \right]
 = \sum_{\vec{x}} \text{Tr}\left[ \Gamma S (x,x) \right] \sum_{\vec{y}} \text{Tr} \left[ \bar{ \Gamma }&#39; S (y,y) \right]\,.\end{equation}
</p>
<p >This means we have to evaluate objects like</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
d(t) = \sum_{\vec{x}} \text{Tr}\left[ \Gamma S (x,x) \right] = \sum_{\vec{x}} \Gamma_{\alpha \beta} S_{\beta \alpha}(x,x)\,,\end{aligned}\end{equation}
</p>
<p >using</p>
<p class="formulaDsp">
\begin{equation}\phi^{(k)}_{\beta, b}(\vec{x}, t; \tau) = \sum_{\vec{y}} S_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) | \eta^{(k)}_{\gamma c }(\vec{y})\rangle\,,\end{equation}
</p>
<p >which implies</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
\frac{1}{K} \sum_{k}^K \sum_{\vec{x}} \text{Tr} \left[ \langle \eta^{(k)}(\vec{x}) | \Gamma | \phi^{(k)} (\vec{x}, t; \tau) \rangle \right] =&amp; \frac{1}{K} \sum_{k}^K \sum_{\vec{x}} \Gamma_{\beta \gamma} | \phi^{(k)}_{\gamma, b}(\vec{x}, t; \tau) \rangle \langle \eta^{(k)}_{\beta b }(\vec{x}) | \\
 =&amp; \frac{1}{K} \sum_{k}^K \sum_{\vec{x}} \Gamma_{\beta \gamma} \sum_{\vec{y}} S_{\gamma \alpha,b c} (\vec{x}, t; \vec{y}, \tau) 
| \eta^{(k)}_{\alpha c }(\vec{y})\rangle \langle \eta^{(k)}_{\beta b }(\vec{x}) |\end{aligned}
\end{equation}
</p>
<p >Using the limit \( K \rightarrow \infty \) this becomes,</p>
<p class="formulaDsp">
\begin{equation}\sum_{\vec{x}} \Gamma_{\beta \gamma} \sum_{\vec{y}} S_{\gamma \alpha,b c} (\vec{x}, t; \vec{y}, \tau) \delta_{bc} \delta_{\alpha \beta} \delta(\vec{y}, \vec{x}) =
\sum_{\vec{x}} \Gamma_{\beta \gamma} S_{\gamma \beta,b b} (\vec{x}, t; \vec{x}, \tau)\,,\end{equation}
</p>
<p class="formulaDsp">
\begin{equation}d(t, \tau) = \text{Tr} \left[ \Gamma S(\vec{x}, t; \vec{x}, \tau) \right]\,.\end{equation}
</p>
<p >We want only cases where \( t = \tau \) so we need either four noise vectors on every timeslice or noise vectors that are nonzero on all timeslices. In the latter case we would evaluate,</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}\frac{1}{K} \sum_{k}^K \sum_{\vec{x}} \text{Tr} \left[ \langle \eta^{(k)}(\vec{x}, t) | \Gamma | \phi^{(k)} (\vec{x}, t) \rangle \right] \end{aligned}\end{equation}
</p>
<p >with</p>
<p class="formulaDsp">
\begin{equation}\phi^{(k)}_{\beta, b}(\vec{x}, t) = \sum_{\vec{y}} S_{\beta\gamma,b c} (\vec{x}, t; \vec{y}, \tau) | \eta^{(k)}_{\gamma c }(\vec{y}, \tau)\,.\rangle\end{equation}
</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Cancelling Backwards Propagation</h2>
<p >The two-point function evaluated in the center of the lattice is (including the backward propagating part to give the extra factor of $2$),</p>
<p class="formulaDsp">
\begin{equation}C(T/2, \vec{p}) = \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) }   2 e^{- E_\pi(\vec{p}) (T/2) }\end{equation}
</p>
<p >therefore</p>
<p class="formulaDsp">
\begin{equation}\frac{1}{2} C(T/2, \vec{p}) e^{ - E_\pi(\vec{p}) (T/2 - t)  } = \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) (T - t) }\end{equation}
</p>
<p >then</p>
<p class="formulaDsp">
\begin{equation}C_{\rightarrow}(t, \vec{p}) = C(t, \vec{p}) - \frac{1}{2} C(T/2, \vec{p}) e^{ - E_\pi(\vec{p}) (T/2 - t)  }\end{equation}
</p>
<p >is the forward propagating part only. \( E_\pi(\vec{p}) \) is obtained by fitting the zero momentum correlator and using \( E(\vec{p}) = \sqrt{m_\pi^2 + \vec{p}^2} \). The factor \( C(T/2, \vec{p}) \) can be obtained also from the zero momentum correlator, by fitting to obtain \( |Z_\pi|^2 \) and using the fact that this is momentum independent. Since \( 0 \) momentum results are used this might not be too noisy.</p>
<p >Alternatively the Wilson action is invariant under</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}\psi(x) \rightarrow {\cal P_\mu}[ \psi(x) ] = \gamma_\mu \psi( P_\mu[x]) \\
\bar{ \psi } (x) \rightarrow {\cal P_\mu}[ \bar{ \psi } (x) ] = \bar{ \psi }( P_\mu[x])  \gamma_\mu \end{aligned}\end{equation}
</p>
<p >where \( P_\mu[x] \) reverses the sign of all the components of \( x \) except the \( \mu \) one. Time reversal corresponds to \( {\cal T} = {\cal P}_1{\cal P}_2{\cal P}_3 \).</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}\psi(x) \rightarrow {\cal T}[ \psi(x) ] = \gamma_0 \gamma_5 \psi( T[x]) \\
\bar{ \psi } (x) \rightarrow {\cal T}[ \bar{ \psi } (x) ] = \bar{ \psi }( T[x])  \gamma_5 \gamma_0 \end{aligned}\end{equation}
</p>
<p >Using this the T symmetry of operators used to construct the correlators can be calculated to calculate the sign on the backwards propagating part.</p>
<p class="formulaDsp">
\begin{equation}\langle O_1(t) O_2(0) \rangle = C(t) = A \left( e^{ -Et} + \tau_1 \tau_2 e^{-E(T - t)}\right)\end{equation}
</p>
<p >Here \( \tau_i = \pm 1 \) is the \( {\cal T} \) eigenvalue of \( O_i \). We mostly use correlators where \( O_1 = O_2 \) so \( \tau_1 \tau_2 = 1 \) then the correlator is</p>
<p class="formulaDsp">
\begin{equation}C_{pp}(t, \vec{p}) = \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) }   \left( e^{- E_\pi(\vec{p})t } + e^{- E_\pi(\vec{p})(T - t) } + e^{- E_\pi(\vec{p})(2T - t) } + \ldots \right)\end{equation}
</p>
<p >The subscript on \( C_{pp} \) refers to the fact that both propagators used periodic boundary conditions. We want to cancel the backwards propagating part which can be done by solving the forward propagator \( S(0,x) \) using antiperiodic time bc's and the backward \( S(x,0) \) with periodic time bc's to give an extra minus sign,</p>
<p class="formulaDsp">
\begin{equation}C_{ap}(t, \vec{p}) = \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) }   \left( e^{- E_\pi(\vec{p})t } - e^{- E_\pi(\vec{p})(T - t) } + e^{- E_\pi(\vec{p})(2T - t) } - \ldots \right)\end{equation}
</p>
<p >so,</p>
<p class="formulaDsp">
\begin{equation}C_{ap}(t, \vec{p}) + C_{p}(t, \vec{p}) = \frac{ 2 |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) }   \left( e^{- E_\pi(\vec{p})t } + e^{- E_\pi(\vec{p})(2T - t) } + \ldots \right)\end{equation}
</p>
<p >cancelling the subleading exponential. This method requires two inversions and the calculation of</p>
<p class="formulaDsp">
\begin{equation}S_{A \pm P} (x,y) = S_A(x,y) \pm S_P(x,y)\end{equation}
</p>
<p >Where the subscript refers to (A)ntiperiodic/(P)eriodic boundary conditions. Then,</p>
<p class="formulaDsp">
\begin{equation}C_{\pm}(t - \tau, 0) = -\sum_{\vec{x} \vec{y}} \text{Tr}\left[ \gamma_5 \Gamma S_{A \pm P} (x,y) \bar{ \Gamma }&#39; \gamma_5 S_{A \pm P} (x,y) \right]\end{equation}
</p>
<p >where \( C_{+}(t - \tau, 0) \) gives the forward propagating part from \( 0 \) to \( T \) and \( C_{-}(t - \tau, 0) \) gives the backwards propagating part from \( 2T \) to \( T \).</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Form Factors and Sequential Sources</h2>
<p >The electromagnetic form factor of a 'pion' requires the evaluation of the matrix element</p>
<p class="formulaDsp">
\begin{equation}\langle \pi(p_f) | V_\mu | \pi(p_i) \rangle = (p_i + p_f)_\mu f(q^2)\end{equation}
</p>
<p >where \( q^2 = (p_i - p_f)^2 \) and</p>
<p class="formulaDsp">
\begin{equation}V_\mu = q_u \bar{u} \gamma_\mu u + q_d \bar{d} \gamma_\mu d\end{equation}
</p>
<p >is the electromagnetic current and \( q_i \) is the charge of the fermion \( i \). This is the local (not conserved) current, so there will be a factor \( Z_V \) for renormalization. The matrix elements required look like:</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C_3(t_f,t,t_i,\vec{p_i}, \vec{p_f}) = Z_V \sum_{\vec{x} \vec{y} \vec{z}} e^{-i\vec{p_f}(\vec{x} - \vec{y}) } e^{i\vec{p_i} (\vec{y} - \vec{z)}}\langle 0 | \bar{u} \gamma_5 d ( \vec{x}, t_f)  V_0(\vec{y}, t) \bar{d} \gamma_5 u (\vec{z}, t_i) | 0 \rangle\end{aligned}\end{equation}
</p>
<p >We take the \( \mu = 0 \) component since this is statistically cleaner and also nonzero independent of the momentum direction. The contractions give three propagators eg. taking the \( \bar{d} \gamma_\mu d \) part of \(V_\mu \),</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
Z_V \sum_{\vec{x} \vec{y} \vec{z}} e^{-i\vec{p_f}(\vec{x} - \vec{y}) } e^{-i\vec{p_i} (\vec{y} - \vec{z} ) } Tr \left[ S_u(\vec{z},t_i;\vec{x},t_f) \gamma_5 S_d(\vec{x},t_f;\vec{y},t)  \gamma_0 S_d(\vec{y},t;\vec{z},t_i) \gamma_5  \right]\end{aligned}\end{equation}
</p>
<p >There are also disconnected contributions from contracting the two fermions in the current together but we ignore those. The usual sequential source trick consists of solving</p>
<p class="formulaDsp">
\begin{equation}S_u(\vec{x}, t; \vec{z}, t_i) = \sum_{\vec{y},\tau} D_u ( \vec{x}, t; \vec{y},\tau)  \delta(\vec{y}, \tau; \vec{z}, t_i)\end{equation}
</p>
<p >to get the point-to-all propagator (for a specific \( \vec{z} \) and \( t_i \) as well as dropping the sum over \( \vec{z} \) and using translational invariance). Then taking a single timeslice of the propagator \( S_u(\vec{x}, t_f; \vec{z}, t_i) \) and solving,</p>
<p class="formulaDsp">
\begin{equation}D_d ( \vec{x},t_f; \vec{y}, t ) G_{du}(\vec{y}, t; \vec{p_f}; t_f; \vec{z}, t_i) = e^{i\vec{p_f} \vec{x}} \gamma_5 S_u(\vec{x}, t_f; \vec{z}, t_i)\end{equation}
</p>
<p class="formulaDsp">
\begin{equation}G_{du}(\vec{y}, t; \vec{p_f}; t_f; \vec{z}, t_i) = \sum_{ \vec{x} } e^{i\vec{p_f} \vec{x}} S_d(\vec{y},t; \vec{x}, t_f ) \gamma_5 S_u(\vec{x}, t_f; \vec{z}, t_i)\end{equation}
</p>
<p >to get the all-to-all-to-point contribution. Then</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}\gamma_5 \left[ G_{du}(\vec{y}, t; \vec{p_f}; t_f; \vec{z}, t_i)  \right]^\dagger \gamma_5 =&amp; \sum_{ \vec{x} } e^{-i\vec{p_f} \vec{x}} \gamma_5 S_u^\dagger (\vec{x}, t_f;\vec{y},t ) \gamma_5 \gamma_5 \gamma_5 \gamma_5 \gamma_5 S_d^\dagger (\vec{z}, t_i;\vec{x}, t_f) \gamma_5 \\
=&amp; \sum_{ \vec{x} } e^{-i\vec{p_f} \vec{x}} S_u (\vec{z}, t_i;\vec{x}, t_f) \gamma_5 S_d (\vec{x}, t_f;\vec{y},t ) \\
=&amp; G_{ud}(\vec{z}, t_i; t_f; \vec{p_f}; \vec{y}, t )\end{aligned}\end{equation}
</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C_3(t_f,t,t_i, \vec{p_i}, \vec{p_f}) = Z_V \sum_{\vec{y} } e^{-i(\vec{p_i} - \vec{p_f})\vec{y}} Tr \left[ G_{ud}(\vec{z}, t_i; t_f; \vec{p_f}; \vec{y}, t )  \gamma_0 S_d(\vec{y},t;\vec{z},t_i) \gamma_5 \right]\end{aligned}\label{eq:3ptfn}\end{equation}
</p>
<p >This \( Z_V \) factor is unknown. We show how to calculate it later, or cancel it, but an alternative is to use the conserved vector current in place of the local current</p>
<p class="formulaDsp">
\begin{equation}V_\mu = \frac{1}{2} \left[ \bar{\psi}(x + \mu)(1 + \gamma_\mu)U_\mu^\dagger(x) \psi(x) - \bar{\psi}(x)(1 - \gamma_\mu)U_\mu^\dagger(x) \psi(x + \mu) \right]\,.\end{equation}
</p>
<p >The trace in eq. \((\ref{eq:3ptfn})\) becomes</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}Tr[ S_d(\vec{y},t+1;\vec{z},t_i) &amp;\gamma_5 (1 + \gamma_0)U_0^\dagger(\vec{y},t) G_{ud}(\vec{z}, t_i; t_f; \vec{p_f}; \vec{y}, t ) -\\ &amp;S_d(\vec{y},t;\vec{z},t_i) \gamma_5 (1 - \gamma_0)U_0(\vec{y},t) G_{ud}(\vec{z}, t_i; t_f; \vec{p_f}; \vec{y}, t+1 ) ]\end{aligned}\end{equation}
</p>
<p >If we use this then all the following formulas are the same except \( Z_V \rightarrow 1 \).</p>
<p >There is an alternative that doesn't require the sequential source trick. Using the properties of our noise sources</p>
<p class="formulaDsp">
\begin{equation}S_d(\vec{x},t_f;\vec{y},t) \approx \frac{1}{K} \sum_{i=0}^K | \psi^{(i)}(\vec{x},t_f) \rangle \langle \eta^{(i)}(\vec{y},t) |\end{equation}
</p>
<p >the three point correlation function becomes</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
Z_V \frac{1}{K} \sum_{i=0}^K \sum_{\vec{x} \vec{y} } e^{-i\vec{p_f}(\vec{x} - \vec{y}) } e^{i\vec{p_i} \vec{y}} Tr \left[  \langle \eta^{(i)}(\vec{y},t) | \gamma_0 S_d(\vec{y},t;\vec{0},0) \gamma_5  S_u(\vec{0},0;\vec{x},t_f) \gamma_5 | \psi^{(i)}(\vec{x},t_f) \rangle \right] \\
Z_V \frac{1}{K} \sum_{i=0}^K \sum_{\vec{x} \vec{y} } e^{-i\vec{p_f}(\vec{x} - \vec{y}) } e^{i\vec{p_i} \vec{y}} Tr \left[  \langle \eta^{(i)}(\vec{y},t) | \gamma_0 S_d(\vec{y},t;\vec{0},0) S_u^{\dagger}(\vec{x},t_f;\vec{0},0) | \psi^{(i)}(\vec{x},t_f) \rangle \right]\end{aligned}\end{equation}
</p>
<p >Using this method we can inject arbitrary momentum at the source without the need for extra inversions.</p>
<h3>Two-Point Functions</h3>
<p >A complete set of hadrons is given by,</p>
<p class="formulaDsp">
\begin{equation}\sum_n \frac{ | n \rangle \langle n |}{ 2 E_n V}\end{equation}
</p>
<p >the first term is the pion. The two-point function (from point sources) is,</p>
<p class="formulaDsp">
\begin{equation}C(t, \vec{p}) = \sum_{\vec{x}} e^{-i \vec{p} \vec{x}} \langle O_\pi (\vec{x}, t) O^\dagger_\pi (\vec{0}, 0)\rangle 
= \sum_{\vec{x}} \sum_n e^{i \vec{p} \vec{x}}  
\frac{ \langle 0 | O_\pi (\vec{x}, t)  | n \rangle \langle n | O^\dagger_\pi (\vec{0}, 0)| 0 \rangle }{ 2 E_n }\end{equation}
</p>
<p >Use \( \sum_{ \vec{y} } e^{-i\vec{p} \vec{y}} O^\dagger_n (\vec{y}, 0) | 0 \rangle  = | n(\vec{p}) \rangle \), the time evolution operator \( e^{-Ht} \) and also the fact that the lightest meson dominates the sum to get</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C(t, \vec{p}) 
&amp;=&amp; \sum_{\vec{x} \vec{y} \vec{z}} \sum_{\vec{p&#39;} } e^{-i \vec{p} \vec{x}}  
\frac{ \langle 0 | O_\pi (\vec{x}, 0)  O^\dagger_\pi (\vec{y}, 0) e^{i \vec{p&#39;} \vec{y} }   | 0 \rangle \langle 0 | e^{i \vec{p&#39;} \vec{z} } O_\pi (\vec{z}, 0) O^\dagger_\pi (\vec{0}, 0)| 0 \rangle }{ 2 E_\pi(\vec{p&#39;}) } e^{- E_\pi(\vec{p&#39;}) t }\end{aligned}\end{equation}
</p>
<p >The sum over \( \vec{p&#39;} \) gives a delta function leaving</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C(t, \vec{p}) 
&amp;=&amp; \sum_{\vec{x} \vec{y} } e^{-i \vec{p} \vec{x}}  
\frac{ \langle 0 | O_\pi (\vec{x}, 0)  O^\dagger_\pi (\vec{y}, 0) | 0 \rangle \langle 0 | O_\pi (\vec{y}, 0) O^\dagger_\pi (\vec{0}, 0) | 0 \rangle }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) t }\end{aligned}\end{equation}
</p>
<p >Translational invariance lets us write</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C(t, \vec{p}) 
&amp;=&amp; \sum_{\vec{x} \vec{y} } e^{-i \vec{p} ( \vec{x} - \vec{y} ) } e^{ -i \vec{p} \vec{y} }  
\frac{ \langle 0 | O_\pi (\vec{0}, 0)  O^\dagger_\pi (\vec{x}-\vec{y}, 0) | 0 \rangle \langle 0 | O_\pi (\vec{y}, 0) O^\dagger_\pi (\vec{0}, 0)| 0 \rangle }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) t }\end{aligned}\end{equation}
</p>
<p >Now changing variables gives us two Fourier transforms</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C(t, \vec{p}) =&amp; \frac{ \langle 0 |  O_\pi (\vec{0}, 0) | \pi(p) \rangle \langle \pi(p) | O^\dagger_\pi (\vec{0}, 0)| 0 \rangle }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) t }\end{aligned}\end{equation}
</p>
<p >and finally using the time evolution operator we get</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned} C(t, \vec{p}) =&amp; \frac{ |Z_\pi|^2 }{ 2 E_\pi(\vec{p}) } e^{- E_\pi(\vec{p}) t }\end{aligned}\end{equation}
</p>
<p >where</p>
<p class="formulaDsp">
\begin{equation}Z_\pi = \langle \pi(p) | O^\dagger_\pi (\vec{0}, 0)| 0 \rangle\end{equation}
</p>
<h3>Three-Point Functions</h3>
<p >In less detail we insert two complete sets of states into the correlator ( point sources so \( (\vec{x_i}, t_i) = (\vec{0}, 0) \) )</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}\langle \pi(p_f) | V_\mu | \pi(p_i) \rangle &amp;=\, \langle 0| O(\vec{p_f}, t_f) V_\mu(\vec{x}, t) O^\dagger(\vec{p_i}, t_i) |0\rangle \\
 &amp;=\, \langle 0| O(\vec{0}, 0) | \pi(\vec{p_f}) \rangle \frac{e^{-(t_f - t) E_\pi(\vec{p_f}) }}{2 E_\pi(\vec{p_f}) } \langle \pi(\vec{p_f}) | V_\mu(\vec{0}, 0) | \pi(\vec{p_i}) \rangle \times \frac{e^{-(t - t_i) E_\pi(\vec{p_i}) }} {2 E_\pi(\vec{p_i}) } \langle \pi(\vec{p_i}) | O^\dagger(\vec{0}, 0) |0 \rangle \\ \nonumber
&amp;=\,  \frac{ Z_{\pi, f}^\dagger Z_{\pi, i} }{4 E(\vec{p_f}) E(\vec{p_i}) } \langle \pi(\vec{p_f}) | V_\mu(\vec{0}, 0) | \pi(\vec{p_i}) \rangle  e^{-(t_f - t) E_\pi(\vec{p_f}) -(t-t_i) E_\pi(\vec{p_i}) }\end{aligned}\end{equation}
</p>
<p >if \( t &lt; t_f \) we have the backwards contribution and the exponential changes to</p>
<p class="formulaDsp">
\begin{equation}-e^{-(t - t_f) E_\pi(\vec{p_f}) -(T - t + t_i) E_\pi(\vec{p_i}) }\end{equation}
</p>
<h3>Correlator Ratios: \(Z_V\)</h3>
<p >\( Z_V \) can be obtained as follows: The ratio,</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}\frac{ C_{\rightarrow}(t_f, \vec{0}) }{ C_3(t_f, t, \vec{p_i}, \vec{p_f}) } =&amp;  
\frac{ \frac{ |Z_\pi( \vec{0} )|^2 }{ 2 m_\pi }   e^{- m_\pi t_f }  }{ \frac{ |Z_\pi( \vec{0} )|^2 }{4 m_\pi^2 } \langle \pi(\vec{0}) | V_\mu | \pi(\vec{0}) \rangle e^{-(t_f - t) m_\pi -t m_\pi } } \\
=&amp; \frac{ 1  }{ \frac{ 1 }{2 m_\pi } \langle \pi(\vec{0}) | V_\mu | \pi(\vec{0}) \rangle } \\
=&amp; \frac{ 1  }{ \frac{ 1 }{2 m_\pi } 2 m_pi f(0)/Z_V } = Z_V.\end{aligned}\end{equation}
</p>
<p >Where we used that the renormalized form factor \( f(0) = 1 \)</p>
<h3>Correlator Ratios: \( f(q) \)</h3>
<p >There are various ways to cancel the unwanted terms and get \( f(q) \).</p>
<h4>RBC-UKQCD Ratio</h4>
<p >We examine the ratio,</p>
<p class="formulaDsp">
\begin{equation}2 m_\pi \frac{ C_{3} (t, t_f, \vec{p}, \vec{0} )  C_{\rightarrow}(t, \vec{0}) }{ C_{3} (t, t_f, \vec{0}, \vec{0} )  C_{\rightarrow}(t, \vec{p}) }\end{equation}
</p>
<p >Assuming \( Z_\pi \) is momentum independent. This also works if \( Z_\pi = E(\vec{p}) f_\pi \), which is the case for \( O = \bar{u} \gamma_0 \gamma_5 d \) type interpolators. The numerator is,</p>
<p class="formulaDsp">
\begin{equation}\frac{ Z_V |Z_\pi|^2 }{ 4 E(\vec{p}) E(\vec{0})} f(q^2) ( E(\vec{p}) + m_\pi ) \frac{|Z_\pi|^2}{2 E(\vec{0})} e^{ -E(\vec{p})t - E(\vec{0})(t_f - t) -E(\vec{0})t }\end{equation}
</p>
<p >and the denominator is,</p>
<p class="formulaDsp">
\begin{equation}\frac{ Z_V |Z_\pi|^2 }{ 4 E(\vec{0}) E(\vec{0})} f(0) ( m_\pi + m_\pi ) \frac{|Z_\pi|^2}{2 E(\vec{p})} e^{ -E(\vec{0})t - E(\vec{0})(t_f - t) -E(\vec{p})t }\end{equation}
</p>
<p >Cancelling leaves,</p>
<p class="formulaDsp">
\begin{equation}2 m_\pi \frac{ C_{3} (t, t_f, \vec{p}, \vec{0} )  C_{\rightarrow}(t, \vec{0}) }{ C_{3} (t, t_f, \vec{0}, \vec{0} )  C_{\rightarrow}(t, \vec{p}) } = f(q^2) ( E(\vec{p}) + m_\pi )\end{equation}
</p>
<p >note there is no \( Z_V \) here.</p>
<h4>Bonnet et. al. Ratio</h4>
<p class="formulaDsp">
\begin{equation}\frac{2 Z_V m_\pi}{E(\vec{p}) + m_\pi} \frac{ C_{3} (t, t_f, \vec{p}, \vec{0} )  C_{\rightarrow}(t, \vec{0}) }{ C_{\rightarrow} (t, \vec{p} )  C_{\rightarrow}(t_f, \vec{0}) }\end{equation}
</p>
<p >the numerator of the right term is,</p>
<p class="formulaDsp">
\begin{equation}\frac{ |Z_\pi|^2 }{ 4 E(\vec{p}) m_\pi} f_B(q^2) ( E(\vec{p}) + m_\pi ) \frac{|Z_\pi|^2}{2 m_\pi} e^{ -E(\vec{p})t - m_\pi(t_f - t) -m_\pi t }\end{equation}
</p>
<p >the denominator of the right term is,</p>
<p class="formulaDsp">
\begin{equation}\frac{ |Z_\pi|^2 }{ 2 m_\pi } \frac{|Z_\pi|^2}{2 E(\vec{p})} e^{ -m_\pi t - m_\pi (t_f - t) -E(\vec{p})t }\end{equation}
</p>
<p >Cancelling leaves,</p>
<p class="formulaDsp">
\begin{equation}\frac{ f_B(q^2) ( E(\vec{p}) + m_\pi ) }{ 2 E(\vec{p}) }\end{equation}
</p>
<p >the kinematic factors are cancelled</p>
<p class="formulaDsp">
\begin{equation}\frac{2 Z_V m_\pi}{E(\vec{p}) + m_\pi} \frac{ f_B(q^2) ( E(\vec{p}) + m_\pi ) }{ 2 E(\vec{p}) } = Z_V f_B(q^2) = f(q^2)\end{equation}
</p>
<p >you need to actually know \( Z_V \) or use the conserved current.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Estimation of Disconnected Contributions</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
Conventions</h2>
<p >We choose the hermitian basis of gamma matrices given in Tab. 1. Each element of the basis is referred by an index in [0,15] shown in the following table</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">No   </th><th class="markdownTableHeadLeft">Matrix    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">0   </td><td class="markdownTableBodyLeft">\( \gamma_5 \)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">1   </td><td class="markdownTableBodyLeft">\( \gamma_1 \)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">2   </td><td class="markdownTableBodyLeft">\( \gamma_2 \)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">3   </td><td class="markdownTableBodyLeft">\( \gamma_3 \)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">4   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_0\gamma_5 \)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">5   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_0\gamma_1 \)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">6   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_0\gamma_2 \)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">7   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_0\gamma_3 \)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">8   </td><td class="markdownTableBodyLeft">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">9   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_5\gamma_1 \)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">10   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_5\gamma_2 \)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">11   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_5\gamma_3 \)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">12   </td><td class="markdownTableBodyLeft">\( \gamma_0 \)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">13   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_5\gamma_0\gamma_1 \)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">14   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_5\gamma_0\gamma_2 \)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">15   </td><td class="markdownTableBodyLeft">\( -\mathrm{i}\gamma_5\gamma_0\gamma_3 \)   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md10"></a>
Singlet Two-Point Functions</h2>
<p >Consider a gauge theory on a group G coupled to \( N_f \) fermions in an arbitrary representation \( R \). Let us denote:</p>
<p class="formulaDsp">
\begin{equation}C(t, x_0) = \dfrac{1}{N_f}\sum_{\vec{x}}\langle \bar{q}\Gamma q(x)\bar{q}\Gamma q(x_0)\rangle\end{equation}
</p>
<p >where \( q \), \(\bar{q} \) are the \( N_f \) quark fields and \( \Gamma \) denotes as arbitrary Dirac structure. The \( 1/N_f \) factor is only there for convenience. The Wick contractions read:</p>
<p class="formulaDsp">
\begin{equation}C(t, x_0) = \sum_{\vec{x}} \langle -\mathrm{tr}\left(\Gamma S(x,x_0)\Gamma S(x_0,x)\right) + N_f\,\mathrm{tr}\left(\Gamma S(x,x)\right)\mathrm{tr}\left(\Gamma S(x_0,x_0)\right)\rangle\end{equation}
</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Stochastic Evaluation of Disconnected Loops</h2>
<p >The simple one consist to evaluate stochastically the disconnected contribution without any variance reduction techniques. Considering a general volume source \( \xi \), we define \( \phi \) using the Dirac operator \( D \) :</p>
<p class="formulaDsp">
\begin{equation}\phi = D^{-1}\xi\end{equation}
</p>
<p >For a given element X of the basis defined in the previous section, we then have</p>
<p class="formulaDsp">
\begin{equation}\sum \left(\xi^{*}X\phi\right)_{R} = \sum XM^{-1} + \text{noise}\end{equation}
</p>
<p >where the symbol \( (\ldots)_{R} \) refers to the average over R samples of the stochastic source.</p>
<p >It should be observed that in evaluating the disconnected contributions to the neutral meson correlators each one of the two quark loops arising from Wick contractions must be averaged over completely independent samples of stochastic sources for the purpose of avoiding unwanted biases.</p>
<h3>Implemented Source Types</h3>
<p >TODO: XX We use XX noise sources. The user can switch between the following different source types</p>
<ul>
<li>type 0: Pure volume source</li>
<li>type 1: Gauge fixed wall source</li>
<li>type 2: Volume sources with time and spin dilution</li>
<li>type 3: Volume sources with time, spin and color dilution</li>
<li>type 4: Volume source with time, spin, color and even-odd dilution</li>
<li>type 6: Volume source with spin, color and even-odd dilution</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
Output</h2>
<p >The code does not perform any average on the stochastic noise or on the dilution indices. This allows to keep as much information as possible and to vary the number of stochastic sources at the analysis level.</p>
<p >The indices are always</p>
<p >TODO: Notation</p>
<p ><code>#T #iGamma #iSrc #\[color and/or e/o \] #Re #Im</code></p>
<p >where iGamma refers to the index of the Gamma matrix defined in Table 1.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Debugging Options</h2>
<p >If the code is executed with the following additional arguments</p>
<div class="fragment"><div class="line">-p  &lt;propagator_name&gt; -s &lt;source_name&gt;</div>
</div><!-- fragment --><p >This will read the two files and perform the contraction accordingly computing \( \chi^{\dagger}\Gamma \psi \).</p>
<h1><a class="anchor" id="autotoc_md14"></a>
Mesonic Correlators of the Isotriplet</h1>
<p >The two fermionic flavors are denoted by \( u \) and \( d \). We are interested in the mesonic correlators</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
&amp;&amp; C_{\Gamma_1,\Gamma_2}(x-y) = \left&lt;
\left( \bar{u} \Gamma_1 d \right)^\dagger(x)
\left( \bar{u} \Gamma_2 d \right)(y)
\right&gt; = \nonumber \\
&amp;&amp; \quad = \left&lt;
\left( \bar{d} \gamma_0 \Gamma_1^\dagger \gamma_0 u \right)(x)
\left( \bar{u} \Gamma_2 d \right)(y)
\right&gt;\end{aligned}\end{equation}
</p>
<p >where \( \Gamma_i \) are the generic products of the \( \gamma\)-matrices.</p>
<p >We can integrate out the fermionic fields explicitly. Here we use the definition \( H(x,y) = G(x,y) \gamma_5 \) for the hermitian Dirac operator, with \( G(x,y) \) defined as its inverse.</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
&amp;&amp; C_{\Gamma_1,\Gamma_2}(x-y) = - \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,y) \Gamma_2 G(y,x) \right]
\right&gt; = \nonumber \\
&amp;&amp; \quad = - \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,y) \Gamma_2 \gamma_5 G(x,y)^\dagger \gamma_5 \right]
\right&gt; = \nonumber \\
&amp;&amp; \quad = - \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 H(x,y) \gamma_5 \Gamma_2 H(x,y)^\dagger \gamma_5 \right]
\right&gt; \; .\end{aligned}\end{equation}
</p>
<p >Since the \( \gamma\)-matrices commute, we can conclude that the matrix \( \gamma_0 \Gamma^\dagger \gamma_0 \) is equal to \( \Gamma \) up to a sign</p>
<p class="formulaDsp">
\begin{equation}\label{eq:gamma0_adj}\gamma_0 \Gamma^\dagger \gamma_0 = s(\Gamma) \Gamma \qquad \text{with } s(\Gamma) = \pm 1 \; .\end{equation}
</p>
<p >In addition, a generic matrix \( \Gamma \) has the following properties:</p>
<ol type="1">
<li>Its matrix elements can be \( 0 \), \( \pm 1 \), \( \pm i \)</li>
<li>Its entries are either all real or all imaginary</li>
<li>In each row and correspondingly each column, there is only one non-zero element</li>
</ol>
<p >Consequently, we can write</p>
<p class="formulaDsp">
\begin{equation}\label{gamma_ab}
\Gamma_{\alpha\beta} = t_\alpha(\Gamma) \delta_{\sigma_\alpha(\Gamma), \beta}\end{equation}
</p>
<p >where \( \sigma(\Gamma) \) constitutes a permutation of four elements. Putting this together we find</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
&amp; C_{\Gamma_1,\Gamma_2}(x-y) = - s(\Gamma_1) \left&lt; \mathrm{tr}
\left[ \gamma_5 \Gamma_1 H(x,y) \gamma_5 \Gamma_2 H(x,y)^\dagger \right]
\right&gt; = \\
&amp; \quad = - s(\Gamma_1) \sum_{\alpha\beta} t_\alpha(\gamma_5 \Gamma_1) t_\beta(\gamma_5 \Gamma_2) \times \left&lt; \mathrm{tr}
\left[ H_{\sigma_\alpha(\gamma_5 \Gamma_1), \beta}(x,y) H_{\alpha, \sigma_\beta(\gamma_5 \Gamma_2)}(x,y)^\dagger \right]
\right&gt; \; .\label{triplet_corr}\end{aligned}\end{equation}
</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Implementation of the Point-To-All Propagator</h2>
<p >In order to calculate mesonic masses we are interested in correlators satisfying \( \Gamma_1=\Gamma_2 \). Using translational invariance, we can set \( y=0 \). In this case the formula simplifies to</p>
<p class="formulaDsp">
\begin{equation}C_{\Gamma}(x) = - s(\Gamma) \sum_{\alpha\beta} t_\alpha(\gamma_5 \Gamma)t_\beta(\gamma_5 \Gamma) \times \left&lt; \mathrm{tr}\left[ H_{\sigma_\alpha(\gamma_5 \Gamma), \beta}(x,0) H_{\alpha, \sigma_\beta(\gamma_5 \Gamma)}(x,0)^\dagger \right]\right&gt; \; .\label{eq:triplet_point_to_all_corr}\end{equation}
</p>
<p >This is implemented into HiRep in the following way</p>
<ul>
<li><p class="startli">The data of the point-like source \( \xi^{(\alpha,a)} \) defined by</p>
<p class="formulaDsp">
\begin{equation}\xi^{(\alpha,a)}_{\beta b}(x) = \delta_{\alpha,\beta} \delta_{a,b} \delta_{x,0} \; ,\end{equation}
</p>
<p class="startli">The function <code>quark_propagator</code> applies the inverse of the hermitian Dirac operator to the source</p>
<p class="formulaDsp">
\begin{equation}\eta^{(\alpha,a)} = H \xi^{(\alpha,a)} \qquad \eta^{(\alpha,a)}_{\beta b}(x) = H_{\beta \alpha}^{b a}(x,0) \; .\end{equation}
</p>
</li>
<li><p class="startli">The functions <code>void *_correlator(float *out, suNf_spinor **qp)</code>in <code>Observables/mesons.c</code> implement the formulae eq. \((\ref{eq:triplet_point_to_all_corr})\), where <code>out</code> stands for the correlator and <code>qp</code> for the spinor array. The functions \( s(\Gamma) \), \( t_\alpha(\gamma_5 \Gamma) \) and \( \sigma_\alpha(\gamma_5 \Gamma) \) where calculated using <code>Mathematica</code>, see file <code>mesons.nd</code> and implemented in the code using macros, defined as follows\</p>
<p class="startli">\ <code>_C1_ =</code> \(\sigma_1(\gamma_5 \Gamma)\)\ <code>_C2_ =</code> \(\sigma_2(\gamma_5 \Gamma)\)\ <code>_C3_ =</code> \(\sigma_3(\gamma_5 \Gamma)\)\ <code>_C4_ =</code> \(\sigma_4(\gamma_5 \Gamma)\)\</p>
<p class="startli">If \( t_\alpha(\gamma_5 \Gamma) \) are read:</p>
<p class="startli">\ <code>_S0_ =</code> \(-s(\Gamma)\)\ <code>_S1_ =</code> \(t_1(\gamma_5 \Gamma)\)\ <code>_S2_ =</code> \(t_2(\gamma_5 \Gamma)\)\ <code>_S3_ =</code> \(t_3(\gamma_5 \Gamma)\)\ <code>_S4_ =</code> \(t_4(\gamma_5 \Gamma)\)\</p>
<p class="startli">whereas if \( t_\alpha(\gamma_5 \Gamma) \) are imaginary:</p>
<p class="startli">\ <code>_S0_ =</code> \(s(\Gamma)\)\ <code>_S1_ =</code> \(-i t_1(\gamma_5 \Gamma)\)\ <code>_S2_ =</code> \(-i t_2(\gamma_5 \Gamma)\)\ <code>_S3_ =</code> \(-i t_3(\gamma_5 \Gamma)\)\ <code>_S4_ =</code> \(-i t_4(\gamma_5 \Gamma)\)\</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md16"></a>
Mesonic Correlators of the Isosinglet</h1>
<p >We are now concerned with the genertic mesonic correlator given by</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C_{\Gamma_1,\Gamma_2}(x-y) &amp;=&amp; \left&lt;
\left( \bar{u} \gamma_0 \Gamma_1^\dagger \gamma_0 u \right)(x)
\left( \bar{u} \Gamma_2 u \right)(y)
\right&gt;\end{aligned}\end{equation}
</p>
<p >considering only a single flavor \( u \).</p>
<p >Integration of the fermionic fields now yiels one additional term, the hairpin diagram</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
C_{\Gamma_1,\Gamma_2}(x-y) =&amp;- \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,y) \Gamma_2 G(y,x) \right]
\right&gt;  + \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,x) \right]
\mathrm{tr}\left[ \Gamma_2 G(y,y) \right]
\right&gt;\\
=&amp; - \left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 H(x,y) \gamma_5 \Gamma_2 H(x,y)^\dagger \gamma_5 \right]
\right&gt; + \left&lt; \mathrm{tr}
\left[ \gamma_5 \gamma_0 \Gamma_1^\dagger \gamma_0 H(x,x) \right]
\mathrm{tr}\left[ \gamma_5 \Gamma_2 H(y,y) \right]
\right&gt;
\; .\end{aligned}\end{equation}
</p>
<p >All other contributions are identical to the contributions to the isotriplet correlator. We can, therefore, focus on the contribution through the hairpin diagram. Using the formulae eq. \((\ref{eq:gamma0_adj})\) we can write</p>
<p class="formulaDsp">
\begin{equation}\left&lt; \mathrm{tr}
\left[ \gamma_0 \Gamma_1^\dagger \gamma_0 G(x,x) \right]
\mathrm{tr}\left[ \Gamma_2 G(y,y) \right] \right&gt; = \quad = s(\Gamma_1) \sum_{\alpha \beta} t_\alpha(\Gamma_1) t_\beta(\Gamma_2) \times \left&lt;
\mathrm{tr}G_{\sigma_\alpha(\gamma_5 \Gamma_1),\alpha}(x,x) \;
\mathrm{tr}G_{\sigma_\beta(\gamma_5 \Gamma_2),\beta}(y,y)
\right&gt;
\; .\label{eq:hairpin}\end{equation}
</p>
<h2><a class="anchor" id="autotoc_md17"></a>
All-to-all Propagator</h2>
<p >It is clear from eq. \((\ref{eq:hairpin})\), from the fact that we are employing point source, that one must compute the entire inverse matrix of the Dirac operator. The alternative is to use a statistic estimate for \( H \) followed by variance reduction procedures.</p>
<p >Suppose there are \( N_s \) available random fermion sources \( \xi^{(i)} \) such that the only non-zero correlators are</p>
<p class="formulaDsp">
\begin{equation}\left&lt; \xi^{(i)}_{\alpha a}(x)^\dagger \xi^{(j)}_{\beta b}(y) \right&gt; = \delta_{\alpha,\beta} \delta_{a,b} \delta_{x,y} \delta_{i,j} \; .\end{equation}
</p>
<p >Current literature proposes mainly either Gaussian noise or \( Z_2 \) noise. In the following, we will choose \( Z_2 \) noise, following <a class="el" href="../../d0/de3/citelist.html#CITEREF_Foster_1999">[5]</a>. Each component of the spinor is randomly chosen from the values \( \pm 1/\sqrt{2} \).</p>
<p >Then the matrix \( H \) can be estimated as follows:</p>
<p class="formulaDsp">
\begin{equation}H_{\alpha \beta}^{a b}(x,y) \simeq \sum_{i=1}^{N_s} \eta^{(i)}_{\alpha a}(x) \xi^{(i)}_{\beta b}(y)^\dagger \eta^{(i)} \equiv H \xi^{(i)}\label{eq:naive_noisy_estimate}\end{equation}
</p>
<p >Stochastic estimation can then be used to calculate the relevant tracks for correlators</p>
<p class="formulaDsp">
\begin{equation}\mathrm{tr}\left[ \Gamma_1 G(x,y) \Gamma_2 G(y,x) \right] = \sum_{ij} \xi^{(i)}(x)^\dagger \gamma_5 \Gamma_1 \eta^{(j)}(x) \times \xi^{(j)}(y)^\dagger \gamma_5 \Gamma_2 \eta^{(i)}(y)\end{equation}
</p>
<p class="formulaDsp">
\begin{equation}\mathrm{tr}\left[ \Gamma G(x,x) \right] = \sum_i \xi^{(i)}(x)^\dagger \gamma_5 \Gamma \eta^{(i)}(x)\, .\end{equation}
</p>
<h2><a class="anchor" id="autotoc_md18"></a>
Variance reduction</h2>
<p >The noise obtained from stochastic estimation of the matrix \( G \) in the formula eq.<code>naive_noisy_estimate</code> can be reduced using the trick from <a class="el" href="../../d0/de3/citelist.html#CITEREF_McNeile_2001">[7]</a> for Wilson fermions. Here, the Dirac operator has the form \( D = 1 - K \). As a result, for the matrix \( G \) the following formula applies</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
&amp;&amp; G = D^{-1} = \left( 1 - K \right)^{-1} = \\
&amp;&amp; \quad = 1 + K + \dots + K^m + K^{n_1} G K^{n_2}\end{aligned}\end{equation}
</p>
<p >with \( n_1 + n_2 = n = m+1 \). In particular, for the evaluation of the hairpin diagram</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
\mathrm{tr}\left[ \Gamma G(x,x) \right] &amp;=&amp; \mathrm{tr}\Gamma + \mathrm{tr}\left[ \Gamma K^4 \right](x,x) + \mathrm{tr}\left[ \Gamma K^6 \right](x,x) + \dots + \\
&amp;&amp; + \mathrm{tr}\left[ \Gamma K^{2k} \right](x,x) + \mathrm{tr}\left[ \Gamma K^{n_1} G K^{n_2} \right](x,x)\end{aligned}\end{equation}
</p>
<p >with \( m=2k \). (TODO: fix this sentence) Here, we can use the fact that the matrix \( K \) connects first neighboring sites as thus \( K^p(x,x) \neq 0 \) only when \( p \) is even. Further, \( r_0=1 \) and consequently \( K^2(x,x) = 0 \) The first \( k+1 \) terms can be calculated explicitly and we can estimate the last term stochastically.</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
\mathrm{tr}\left[ \Gamma G(x,x) \right] =&amp; \mathrm{tr}\Gamma + \mathrm{tr}\left[ \Gamma K^4 \right](x,x) + \mathrm{tr}\left[ \Gamma K^6 \right](x,x) + \dots + \nonumber \\
&amp; + \mathrm{tr}\left[ \Gamma K^{2k} \right](x,x) + \sum_{iy} \xi^{(i)}(y)^\dagger \gamma_5 K^{n_2}(y,x) \Gamma K^{n_1}(x,y) \eta^{(i)}(y) \nonumber \\
\end{aligned}\label{eq:hairpin_with_variance_reduction}\end{equation}
</p>
<p ><a class="el" href="../../d0/de3/citelist.html#CITEREF_McNeile_2001">[7]</a> use this trick only for the calculation of the hairpin diagram. It might be possible to generalize it to the the isotriplet part as well, as an alternative to the point-to-all propagator.</p>
<h2><a class="anchor" id="autotoc_md19"></a>
Time dilution</h2>
<p >This is a trick introduced in <a class="el" href="../../d0/de3/citelist.html#CITEREF_Foley_2005">[4]</a> for noise reduction in the computation of null-moment propagators. Whenever stochastic estimation of the \( H \) matrix is required, such as in eq. \((\ref{eq:naive_noisy_estimate})\), it is possible to replace each stochastic source \( \xi^{(i)} \) with a set of sources each with support on a different time slice.</p>
<p class="formulaDsp">
\begin{equation}\begin{aligned}
 \label{time_dilution}
&amp;&amp; \xi^{(i)} \rightarrow \xi^{(i,\tau)}(\mathbf{x},t) = \xi^{(i)}(\mathbf{x},t) \delta_{t,\tau}\end{aligned}\end{equation}
</p>
<p >Stochastic estimation is now obtained similarly to the naive case:</p>
<p class="formulaDsp">
\begin{equation}H_{\alpha \beta}^{a b}(x,y) \simeq \sum_{i=1}^{N_s} \sum_{\tau=1}^{N_t} \eta^{(i,\tau)}_{\alpha a}(x) \xi^{(i,\tau)}_{\beta b}(y)^\dagger  \eta^{(i,\tau)} \equiv H \xi^{(i,\tau)}\label{eq:diluted_noisy_estimate}\end{equation}
</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Implementation Scheme</h2>
<p >TODO: Add this to function reference instead if this is still implemented this way</p>
<p >The following functions will be implemented</p>
<ul>
<li>Calculation of the exact terms of the formula eq.<code>hairpin_with_variance_reduction</code></li>
<li><p class="startli"><br  />
 \ <code>void GAMMA_variance_reduction_exact_terms(float *out, int k)</code></p>
<p class="startli">Here, <code>out</code> is a real vector with its components equal to the volume and \( k \) corresponds to the index in the \( \gamma\)-matrix.</p>
<p class="startli">This function evaluates</p>
<p class="formulaDsp">
\begin{equation}h_k(x) = \mathrm{tr}\left[ \Gamma K^{2k} \right](x,x) = \left( \frac{\kappa}{2} \right)^{2k} \sum_{\mathcal{C}_x} \mathrm{tr}\left( \Gamma \tilde{\gamma}(\mathcal{C}_x) \right) \mathcal{W}(\mathcal{C}_x)\end{equation}
</p>
<p class="startli">where \( \mathcal{C}_x = (x,\hat{\mu}_1,\hat{\mu}_2,\dots,\hat{\mu}_{2k}) \) is the generic closed path of \( x \) of length \( 2k \) obtained by moving from \( x \) in the directions \( \hat{\mu}_i \). \( \mathcal{W}(\mathcal{C}_x) \) is the trace of the parallel transport through \( \mathcal{C}_x \) in the corresponding fermionic representation. \( \tilde{\gamma}(\mathcal{C}_x) \). is the matrix defined as</p>
<p class="formulaDsp">
\begin{equation}\tilde{\gamma}(\mathcal{C}_x) = (1-\gamma_{\hat{\mu}_1})(1-\gamma_{\hat{\mu}_2})\cdots(1-\gamma_{\hat{\mu}_{2k}})\end{equation}
</p>
<p class="startli">having defined \( \gamma_{-\hat{\mu}_i} = - \gamma_{\hat{\mu}_i} \).</p>
<p class="startli">It should be noted that since \( (1-\gamma_{\hat{\mu}_i})(1-\gamma_{-\hat{\mu}_i}) = 0 \), one can exclude the paths in which a pair of subsequences \( (\dots, \hat{\mu}_i,-\hat{\mu}_i, \dots) \) appears from the sum. In addition, the matrix \( \tilde{\gamma}(\mathcal{C}_x) \) does not depend on \( x \). There is is convenient to compute the list of paths and the matrix \( \tilde{\gamma}(\mathcal{C}_x) \) only once.</p>
</li>
<li>It is convenient to have a function that calculates the traces of the parallel transports:</li>
<li><p class="startli"><br  />
 <code>void tr_r_pexp(complex *out, int *path, int length)</code></p>
<p class="startli">Here again <code>out</code> is the complex vector with number of components according to the volume and \( \phi(x) \) \ is the number of directions (<code>length</code>) of which the path is composed.</p>
<p class="startli">This returns</p>
<p class="formulaDsp">
\begin{equation}\phi(x) = \mathrm{tr}\mathbf{R} \left[ U_{x, \hat{\mu}_1} U_{x+\hat{\mu}_1, \hat{\mu}_2} \cdots \right]\end{equation}
</p>
</li>
<li><p class="startli">Calculation of the time-diluted estimators</p>
<p class="startli"><code>void time_diluted_stochastic_estimate</code>\ <code>(suNf_spinor *csi, suNf_spinor **eta,</code>\ <code>int nm, float *mass, double ac)</code>\</p>
<p class="startli">With the parameters: <code>csi</code> is the spinor \( \xi\)\ <code>path</code> is the list of \( N_t \times \textrm{nm} \) spinors along the \( \eta^{(\tau,m)}\) \</p>
<p class="startli">This function generates the spinor \( \xi \) with \( Z_2 \) noise. Here the spinors are defined as</p>
<p class="formulaDsp">
\begin{equation}\xi^{(\tau)}(\mathbf{x},t) = \xi(\mathbf{x},t) \delta_{t,\tau}\end{equation}
</p>
<p class="startli">and then returned as</p>
<p class="formulaDsp">
\begin{equation}\eta^{(\tau,m)} \equiv H_m \xi^{(\tau)}\end{equation}
</p>
<p class="startli">using the inverter of the Dirac operator with parameters <code>nm</code>, <code>mass</code> and <code>acc</code>.</p>
<p class="startli">The calculation of the hairpin term</p>
<p class="startli">\ <code>void GAMMA_hairpin_VR_TD(float **out,</code>\ <code>int n1, int n2, int nrs,</code>\ <code>int nm, float *mass, double acc)</code>\</p>
<p class="startli">Takes the parameters <code>out</code> = list of real <code>nm</code> vectors with the number of components corresponding to the volume <code>n1, n2</code> = parameters of the variance reduction algorithm <code>nrs</code> = number of random sources for the statistical estimation <code>nm, mass</code> = number and list of masses <code>acc</code> = inverter parameter \</p>
</li>
</ul>
<p >The functions above implement the formula eq. \((\ref{eq:hairpin_with_variance_reduction})\), summing exact terms and the statistical term, generated with <code>nrs</code> to dilute, for a total of \( \times N_t \) matrix invertions for each mass value and returns the result as <code>out</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
